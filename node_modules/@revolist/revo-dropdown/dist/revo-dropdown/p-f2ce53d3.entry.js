import{h as t,r as e,c as i,H as o}from"./p-d2fb933e.js";(function t(){if(!Element.prototype.matches){Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector}if(!Element.prototype.closest){Element.prototype.closest=function(t){let e=this;do{if(Element.prototype.matches.call(e,t)){return e}e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===1);return null}}})();const s="uuid";function n(t,e){if(!t){return""}return e?t[e]:t}function r(t,e){return e?t[e]:t}function d(t,e){var i;let o=[];const s=(i=e===null||e===void 0?void 0:e.trim())===null||i===void 0?void 0:i.toLocaleLowerCase();if(!s){o=t.source}else{for(let e of t.source){let i=n(e,t.dataLabel);if(typeof i==="string"){i=i.toLocaleLowerCase();switch(t.filter){case"start":if(i.indexOf(s)===0){o.push(e)}break;default:if(i.indexOf(s)>-1){o.push(e)}break}}}}return o}const l=e=>{const i=t=>{const i=d(e,t);e.onFilterChange({value:t,items:i})};if(!e.filter){e.filter="contains"}i(e.filterValue);if(e.autocomplete){e.value=e.filterValue}return t("input",Object.assign({class:{"filter-box":true},type:"text"},e,{onClick:t=>{t.preventDefault();e.onClick&&e.onClick(t)},onInput:t=>{var o;e.onInput&&e.onInput();const s=(o=t.currentTarget)===null||o===void 0?void 0:o.value;i(s)}}))};const a=()=>t("span",{class:"arrow-wrapper"},t("svg",{class:"arrow","aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512"},t("path",{fill:"currentColor",d:"M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41z"})));const h='revo-dropdown{font-size:1em;font-family:"Roboto", "Helvetica", "Arial", sans-serif;font-weight:400;line-height:2em;letter-spacing:0.01em;display:inline-flex;flex-direction:column;vertical-align:top;padding:0;box-sizing:border-box;cursor:pointer;position:relative}revo-dropdown .rv-dr-root{padding:5px 9px;padding-right:35px;flex-wrap:wrap;position:relative;border-radius:4px;cursor:text;display:inline-flex;position:relative;font-size:1rem;box-sizing:border-box;align-items:center}revo-dropdown input.filter-box{padding-left:6px;padding:9.5px 4px;width:0;min-width:30px;flex-grow:1;text-overflow:ellipsis;border:0;height:1.1876em;margin:0;display:block;background:none;box-sizing:content-box;letter-spacing:inherit;animation-duration:10ms}revo-dropdown input.filter-box:focus{outline:none}revo-dropdown .actions{right:9px;top:calc(50% - 14px);position:absolute}revo-dropdown label{font-size:1rem;z-index:100;top:0;left:0;position:absolute;display:block;transform-origin:top left;line-height:1;transition:color 200ms cubic-bezier(0, 0, 0.2, 1) 0ms, transform 200ms cubic-bezier(0, 0, 0.2, 1) 0ms;transform:translate(14px, 14px) scale(1);pointer-events:none}revo-dropdown fieldset{border-color:#ececec;top:-5px;left:0;right:0;bottom:0;margin:0;padding:0 8px;overflow:hidden;position:absolute;z-index:0;border-style:solid;border-width:1px;border-radius:inherit;pointer-events:none}revo-dropdown fieldset legend{width:auto;height:11px;display:block;padding:0;font-size:0.75em;max-width:0.01px;text-align:left;transition:max-width 50ms cubic-bezier(0, 0, 0.2, 1) 0ms;visibility:hidden}revo-dropdown fieldset legend>span{display:inline-block;padding-left:5px;padding-right:5px}revo-dropdown.shrink label{transform:translate(14px, -6px) scale(0.75)}revo-dropdown.shrink legend{max-width:1000px;transition:max-width 100ms cubic-bezier(0, 0, 0.2, 1) 50ms}revo-dropdown .arrow{width:9px;margin-top:5px;margin-left:5px;opacity:0.4}revo-dropdown .arrow-wrapper{width:15px;text-align:center}revo-dropdown.active label{color:#0089ff}revo-dropdown.active fieldset{border-color:#0089ff}.revo-dropdown-list{font-size:1em;font-family:"Roboto", "Helvetica", "Arial", sans-serif;font-weight:400;line-height:2em;letter-spacing:0.01em;position:absolute;transition:opacity 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, transform 160ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;z-index:999;display:none;opacity:0}.revo-dropdown-list.top .dropdown-inner{bottom:2px;flex-direction:column-reverse}.revo-dropdown-list.top .dropdown-inner .filter-box{margin-bottom:0}.revo-dropdown-list:not(.top) .dropdown-inner{top:2px;flex-direction:column}.revo-dropdown-list:not(.top) .dropdown-inner .filter-box{margin-top:0}.revo-dropdown-list .dropdown-inner{display:flex;max-height:100%;position:absolute;padding:8px 0;box-sizing:border-box;min-height:16px;min-width:16px;box-shadow:0 0 14px 0 rgba(53, 64, 82, 0.05);border:1px solid rgba(0, 0, 0, 0.05);border-radius:4px;color:rgba(0, 0, 0, 0.87);overflow:hidden;background-color:#fff}.revo-dropdown-list .dropdown-inner .filter-box{border:1px solid #ececec;min-height:30px;line-height:30px;margin:10px;border-radius:6px}.revo-dropdown-list .dropdown-inner .filter-box:focus{outline:none;border-color:#0089ff}';const c=h;const f=class{constructor(t){e(this,t);this.changeValue=i(this,"changed",7);this.close=i(this,"close",7);this.open=i(this,"open",7);this.uuid="";this.isClosing=false;this.currentItem=null;this.isVisible=false;this.dataLabel=undefined;this.value=undefined;this.currentFilter=undefined;this.dataId=undefined;this.autoClose=true;this.source=[];this.placeholder="Select";this.appendTo="body";this.filter=undefined;this.maxHeight=undefined;this.hasFilter=true;this.autocomplete=false;this.autoFocus=false;this.template=undefined}async doClose(t=false){if(!t){const t=this.close.emit();if(t.defaultPrevented){return}}this.isClosing=true;this.isVisible=false}async doOpen(){const t=this.open.emit();if(t.defaultPrevented){return}this.isVisible=true}async doChange(t,e){this.value=r(t,this.dataId);this.changeValue.emit({val:this.value,originalEvent:e});if(this.autocompleteInput){this.autocompleteInput.value=n(this.currentItem,this.dataLabel)}if(this.autoClose&&this.isVisible){this.doClose()}}onMouseUp(t){var e;if(this.isVisible&&!t.defaultPrevented){const i=!((e=t.target)===null||e===void 0?void 0:e.closest(`[${s}="${this.uuid}"]`));if(i){this.doClose()}}}onKey(t){switch(t.code){case"Escape":t.preventDefault();this.doClose();break}}onValueChanged(t){this.currentItem=this.getValue(t)}componentWillLoad(){if(this.value){this.currentItem=this.value}}connectedCallback(){this.uuid=`${this.uuidv4((new Date).getTime())}-rvdropdown`;if(typeof this.value!=="undefined"){this.onValueChanged(this.value)}}disconnectedCallback(){this.doClose(true)}componentDidRender(){if(this.dropdown){if(this.appendTo==="body"){document.body.appendChild(this.dropdown)}else if(this.appendTo!=="current"&&typeof this.appendTo==="string"){const t=document.querySelector(this.appendTo);if(t instanceof HTMLElement){t.appendChild(this.dropdown)}}}if(this.isVisible){this.updateStyles()}if(this.dropdownInput){this.dropdownInput.focus()}if(this.autoFocus){if(this.autocomplete){setTimeout((()=>{var t;return(t=this.autocompleteInput)===null||t===void 0?void 0:t.focus()}),0)}}}renderDropdown(){return t("div",{class:"revo-dropdown-list",ref:t=>this.dropdown=t},t("div",{[s]:this.uuid,class:"dropdown-inner",ref:t=>this.dropdownInner=t},this.hasFilter&&!this.autocomplete?t(l,{ref:t=>this.dropdownInput=t,source:this.source,filter:this.filter,dataLabel:this.dataLabel,value:this.currentFilter||"",filterValue:this.currentFilter||"",onFilterChange:t=>{var e;this.currentFilter=t.value;this.currentSource=t.items;(e=this.revoList)===null||e===void 0?void 0:e.refresh(this.currentSource)}}):undefined,t("revo-list",{ref:t=>this.revoList=t,isFocused:true,selectedIndex:this.getValueIndex(this.value),sourceItems:this.currentSource,onChanged:t=>this.doChange(t.detail.item,t.detail.e),template:e=>this.template?this.template(t,e):n(e,this.dataLabel)})))}renderSelect(){const e=this.currentItem&&n(this.currentItem,this.dataLabel)||"";return t("input",{type:"text",disabled:true,class:"filter-box",value:e})}renderAutocomplete(){const e=this.currentItem?n(this.currentItem,this.dataLabel):"";return t(l,{ref:t=>this.autocompleteInput=t,autocomplete:"true",source:this.source,filter:this.filter,dataLabel:this.dataLabel,value:e,filterValue:this.currentFilter,onKeyDown:t=>{if(this.isVisible){return}switch(t.code){case"ArrowUp":case"ArrowDown":t.preventDefault();this.showAutoComplete();break}},onInput:()=>this.showAutoComplete(),onFocus:()=>this.showAutoComplete(),onClick:()=>this.showAutoComplete(),onFilterChange:t=>{var e;this.currentFilter=t.value;this.currentSource=t.items;(e=this.revoList)===null||e===void 0?void 0:e.refresh(this.currentSource)}})}render(){var e;let i;if(this.isVisible){i=this.renderDropdown()}const n={[s]:this.uuid,class:{active:this.isVisible,shrink:this.isVisible||!!this.currentItem||!!((e=this.autocompleteInput)===null||e===void 0?void 0:e.value)},ref:t=>this.element=t,onClick:t=>this.selectClick(t)};if(this.autocomplete){n["autocomplete"]=true}return t(o,Object.assign({key:"c76b30c10b5d5727112a1912be87324b54af9c57"},n),t("label",{key:"a7bb046d9863866d356c2b61c5af5402d96dd260"},this.placeholder),t("div",{key:"7c04280ed41bae735b82346e2f96ca0a980b3a58",class:"rv-dr-root"},this.autocomplete?this.renderAutocomplete():this.renderSelect(),t("span",{key:"1ba2e9d1d18c3e9f3fece999d6fc7bbf8fb4947f",class:"actions"},t(a,{key:"2249cb5299f24011e47fe38ea36afe3effba3c94"})),t("fieldset",{key:"1ad14cb273cfd420aaf6c847b950e780f748c63c"},t("legend",{key:"cc3810362cb47b96c56487ee833de6bc90a594e8"},t("span",{key:"4bfccee1d4e13fda7eadf428c250ae58f30f9d2e"},this.placeholder)))),i)}showAutoComplete(){if(!this.isVisible&&!this.isClosing){this.isVisible=true}this.isClosing=false}getValueIndex(t){let e=0;for(let i in this.source){const o=this.source[i];if(t==r(o,this.dataId)){return e}e++}return-1}getValue(t){for(let e in this.source){const i=this.source[e];if(t==r(i,this.dataId)){return i}}return null}selectClick(t){if(t.defaultPrevented){return}if(this.isVisible){this.doClose()}else{this.doOpen()}}updateStyles(){if(!this.dropdown){return}const{top:t,left:e,height:i}=this.element.getBoundingClientRect();const o=this.clientRectangle();let s=t+i+o.top;const n={opacity:1,display:"block"};if(s>o.centerY){n.top=`${s-i}px`;n.maxHeight=s-i-o.top-50;this.dropdown.classList.add("top")}else{n.top=`${s}px`;n.maxHeight=o.bottom-s-50;this.dropdown.classList.remove("top")}let r=e+o.left;const d=o.right-(r+this.dropdown.clientWidth);if(d<0){r+=d}n.left=`${r}px`;this.dropdownInner.style.maxHeight=`${Math.min(n.maxHeight,this.maxHeight||n.maxHeight)}px`;this.dropdownInner.style.maxWidth=n.maxWidth;for(let t in n){this.dropdown.style[t]=n[t]}}clientRectangle(){const t={top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,bottom:0,centerY:0,height:document.body.clientHeight,left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,right:0,width:document.body.clientWidth,centerX:0};t.bottom=t.top+t.height;t.right=t.left+t.width;t.centerY=t.top+t.height/2;t.centerX=t.left+t.width/2;return t}uuidv4(t){return`${t}-xx-y`.replace(/[xy]/g,(t=>{var e=Math.random()*16|0,i=t=="x"?e:e&3|8;return i.toString(16)}))}static get watchers(){return{value:["onValueChanged"]}}};f.style=c;const p="revo-list{overflow-x:hidden;overflow-y:auto;max-height:100%;display:block}revo-list ul{margin:0;padding:0;outline:0;list-style:none}revo-list ul>li{width:auto;overflow:hidden;font-size:14px;box-sizing:border-box;min-height:48px;font-weight:400;line-height:1.5;padding-top:6px;white-space:nowrap;padding-bottom:6px;padding-left:16px;padding-right:16px;display:flex;position:relative;text-align:left;align-items:center;justify-content:flex-start;text-decoration:none;cursor:pointer}revo-list ul>li.selected{background-color:rgba(0, 0, 0, 0.04)}revo-list ul>li:hover{background-color:rgba(0, 0, 0, 0.04)}";const u=p;const b=class{constructor(t){e(this,t);this.changed=i(this,"changed",3);this.currentItem=0;this.sourceItems=[];this.isFocused=false;this.selectedIndex=0;this.template=undefined}onKey(t){let e;if(!this.isFocused){return}switch(t.code){case"ArrowUp":t.preventDefault();if(this.currentItem<=0){return}this.currentItem--;break;case"ArrowDown":t.preventDefault();if(this.sourceItems[this.currentItem+1]){this.currentItem++}break;case"Tab":t.preventDefault();e=this.sourceItems[this.currentItem];if(e){this.changed.emit({item:e,e:t})}break;case"Enter":t.preventDefault();e=this.sourceItems[this.currentItem];if(e){this.changed.emit({item:e,e:t})}break}}async refresh(t){this.sourceItems=t}valueChanged(t){this.currentItem=t}componentWillLoad(){this.valueChanged(this.selectedIndex)}componentDidRender(){var t;(t=this.selectedEl)===null||t===void 0?void 0:t.scrollIntoView({block:"nearest",inline:"nearest"})}render(){this.selectedEl=undefined;const e=[];for(let i in this.sourceItems){const o=this.sourceItems[i];const s=parseInt(i)===this.currentItem;const n={class:{selected:s},ref:t=>{if(s){this.selectedEl=t}},onClick:t=>this.changed.emit({item:o,e:t})};const r=t("li",Object.assign({key:"cb47c8bde7b1a4229675c49daad83816e03e1461"},n),this.template(o));e.push(r)}return t("ul",{key:"3a77f6a7bb446d5f380b4f4e774906f59d36e31f"},e)}static get watchers(){return{selectedIndex:["valueChanged"]}}};b.style=u;export{f as revo_dropdown,b as revo_list};
//# sourceMappingURL=p-f2ce53d3.entry.js.map